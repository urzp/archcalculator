Ключевые события вебхуков Stripe
Когда пользователь завершает оформление подписки, вы получите несколько вебхуков. Вот основные события, которые нужно обработать:

checkout.session.completed:
Этот вебхук триггерится, когда пользователь успешно завершает оформление подписки. Используйте это событие, чтобы получить customer_id и сохранить его в вашей базе данных, ассоциировав с вашим user_id.

customer.subscription.created:
Это событие возникает, когда новая подписка создаётся. Вы можете использовать его для дополнительных действий, если это необходимо.

customer.subscription.updated:
Срабатывает, когда происходит обновление подписки (например, изменение тарифного плана и др.).

customer.subscription.deleted:
Вызывается, когда подписка отменяется. Это событие полезно для управления статусом подписки в вашей базе данных.

invoice.payment_succeeded:
Уведомляет вас о том, что платеж за подписку прошел успешно. Вы можете использовать его, чтобы обновить статус подписки и пользователя.

invoice.payment_failed:
Предупреждает, если платеж не удался. Это поможет вам отслеживать и уведомлять пользователей о проблемах с платежами.



https://buy.stripe.com/test_7sY3cx0l0fMLf2qc7Gd7q00